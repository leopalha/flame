# ğŸ”„ FLAME - USER FLOWS

**VersÃ£o:** 3.6.0
**Ãšltima AtualizaÃ§Ã£o:** 09/12/2024
**Sincronizado com:** CÃ³digo-fonte e PRD v3.6.0 (Sprints 54-58: Atendente, Gorjeta, Chat, Sons, Pagamentos)

## ÃNDICE

1. [Fluxos do Cliente](#1-fluxos-do-cliente)
2. [Fluxos do Staff](#2-fluxos-do-staff)
3. [Fluxos Administrativos](#3-fluxos-administrativos)
4. [Fluxos do Sistema](#4-fluxos-do-sistema)
5. [Mapeamento TÃ©cnico](#5-mapeamento-tÃ©cnico)
6. [DivergÃªncias Conhecidas](#6-divergÃªncias-conhecidas)

---

## LEGENDA DE STATUS

| SÃ­mbolo | Significado |
|---------|-------------|
| âœ… | Implementado e funcionando |
| âš ï¸ | Parcialmente implementado ou com divergÃªncia |
| âŒ | NÃ£o implementado |
| ğŸ”„ | Em desenvolvimento |

---

## 1. FLUXOS DO CLIENTE

### 1.1 Cadastro e AutenticaÃ§Ã£o

#### 1.1.1 Primeiro Acesso (via QR da Mesa)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ENTRADA VIA QR                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  [Cliente escaneia QR na mesa]                         â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ URL: /qr/mesa-{id}  â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ Sistema detecta:    â”‚                               â”‚
â”‚  â”‚ â€¢ Mesa ID           â”‚                               â”‚
â”‚  â”‚ â€¢ Salva em session  â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚      â”‚ Tem sessÃ£o?   â”‚                                 â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚              â”‚                                          â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚      â”‚               â”‚                                 â”‚
â”‚      â–¼               â–¼                                 â”‚
â”‚    [SIM]           [NÃƒO]                               â”‚
â”‚      â”‚               â”‚                                 â”‚
â”‚      â–¼               â–¼                                 â”‚
â”‚  /cardapio      /bem-vindo                             â”‚
â”‚  (mesa jÃ¡       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚   definida)     â”‚ OpÃ§Ãµes:     â”‚                        â”‚
â”‚                 â”‚ â€¢ Entrar    â”‚                        â”‚
â”‚                 â”‚ â€¢ Cadastrar â”‚                        â”‚
â”‚                 â”‚ â€¢ SÃ³ ver    â”‚                        â”‚
â”‚                 â”‚   cardÃ¡pio  â”‚                        â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.1.2 Cadastro Completo (Tradicional) âš ï¸ ATUALIZADO

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 CADASTRO COMPLETO (/register)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  FormulÃ¡rio:                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Nome Completo *:   [_______________________]                â”‚    â”‚
â”‚  â”‚ Email *:           [_______________________]                â”‚    â”‚
â”‚  â”‚ Celular *:                                                  â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚ â”‚ [ğŸ‡§ğŸ‡· Brasil +55 â–¼] [(21) 99999-9999  ]                 â”‚ â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â”‚ â†‘ Ao clicar, abre lista pesquisÃ¡vel de paÃ­ses:              â”‚    â”‚
â”‚  â”‚   ğŸ” Buscar paÃ­s...                                         â”‚    â”‚
â”‚  â”‚   ğŸ‡§ğŸ‡· Brasil +55 | ğŸ‡ºğŸ‡¸ EUA +1 | ğŸ‡µğŸ‡¹ Portugal +351 | ...    â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ âš¡ Sistema detecta automaticamente pelo paÃ­s do telefone:   â”‚    â”‚
â”‚  â”‚    - Se Brasil â†’ mostra campo CPF                           â”‚    â”‚
â”‚  â”‚    - Se outro paÃ­s â†’ mostra campo ID Estrangeiro            â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Data de Nascimento *: [DD/MM/AAAA]                          â”‚    â”‚
â”‚  â”‚ âš ï¸ VocÃª precisa ter 18 anos ou mais                         â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ [Se paÃ­s = Brasil - detectado automaticamente]              â”‚    â”‚
â”‚  â”‚ CPF *:             [000.000.000-00      ] âœ“ Validado        â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ [Se paÃ­s â‰  Brasil - detectado automaticamente]              â”‚    â”‚
â”‚  â”‚ NÂº IdentificaÃ§Ã£o *: [Passaporte/RNE     ]                   â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Senha:            [___________] (min 6 chars)               â”‚    â”‚
â”‚  â”‚ Confirmar Senha:  [___________]                             â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ [âœ“] Aceito os Termos de Uso e PolÃ­tica de Privacidade      â”‚    â”‚
â”‚  â”‚ [âœ“] Declaro ter 18 anos ou mais                            â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ [          Criar Conta          ]                           â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ou â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ [   G   Cadastrar com Google    ]                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                     â”‚
â”‚                     POST /api/auth/register                         â”‚
â”‚         { nome, email, celular, birthDate, cpf/foreignId, password }â”‚
â”‚                                â”‚                                     â”‚
â”‚                                â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Backend:                                                    â”‚    â”‚
â”‚  â”‚ 1. Valida unicidade: email, celular (e cpf se fornecido)   â”‚    â”‚
â”‚  â”‚ 2. Cria User com profileComplete: true, phoneVerified: falseâ”‚   â”‚
â”‚  â”‚ 3. Gera cÃ³digo SMS 6 dÃ­gitos (expira em 5 min)             â”‚    â”‚
â”‚  â”‚ 4. Envia SMS via Twilio                                    â”‚    â”‚
â”‚  â”‚ 5. Retorna { userId, celular, smsExpiry }                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                     â”‚
â”‚                                â–¼                                     â”‚
â”‚  Tela de VerificaÃ§Ã£o SMS:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚        CÃ³digo Enviado!                                      â”‚    â”‚
â”‚  â”‚    Enviamos um cÃ³digo para +55 21 99999-9999               â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚    [ 0 ] [ 0 ] [ 0 ] [ 0 ] [ 0 ] [ 0 ]                     â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚    [     Verificar CÃ³digo      ]                            â”‚    â”‚
â”‚  â”‚    NÃ£o recebeu? [Reenviar]                                  â”‚    â”‚
â”‚  â”‚    [     Voltar     ]                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                     â”‚
â”‚                     POST /api/auth/verify-sms                       â”‚
â”‚                    { celular, code }                                â”‚
â”‚                                â”‚                                     â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                  â”‚                           â”‚                      â”‚
â”‚              CÃ³digo OK               CÃ³digo Errado                  â”‚
â”‚                  â”‚                           â”‚                      â”‚
â”‚                  â–¼                           â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ phoneVerified=true â”‚       â”‚ smsAttempts++ (mÃ¡x 3)      â”‚       â”‚
â”‚  â”‚ smsCode=null       â”‚       â”‚ Erro: "CÃ³digo incorreto"   â”‚       â”‚
â”‚  â”‚ Gera JWT token     â”‚       â”‚ Tentativas restantes: X    â”‚       â”‚
â”‚  â”‚ Envia SMS welcome  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚           â”‚                                                          â”‚
â”‚           â–¼                                                          â”‚
â”‚  Redirect: / (home baseado na role)                                 â”‚
â”‚  Toast: "Cadastro concluÃ­do! Bem-vindo ao FLAME!"                   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Mapeamento TÃ©cnico:**

| Componente | Arquivo | FunÃ§Ã£o |
|------------|---------|--------|
| Frontend Page | `pages/register.js` | FormulÃ¡rio com validaÃ§Ã£o |
| Store | `stores/authStore.js` | `register()`, `verifySMS()` |
| Backend Controller | `controllers/authController.js` | `register()`, `verifySMS()` |
| Service SMS | `services/sms.service.js` | `generateSMSCode()`, `sendVerificationCode()` |
| Model | `models/User.js` | 26 campos (ver PRD 2.1.1) |
| Rota | `routes/auth.js` | `POST /register`, `POST /verify-sms` |

**Campos Criados no User:**
```javascript
{
  nome: "Nome Informado",
  email: "email@exemplo.com",
  celular: "+5521999999999",
  password: "[hash bcrypt]",
  profileComplete: true,  // JÃ¡ tem nome + email
  phoneVerified: false,   // â†’ true apÃ³s SMS
  smsCode: "123456",      // â†’ null apÃ³s verificaÃ§Ã£o
  smsCodeExpiry: Date,    // +5 minutos
  smsAttempts: 0,         // â†’ incrementa a cada erro
  role: "cliente",
  isActive: true
}
```

> **âš ï¸ DIVERGÃŠNCIA**: O bÃ´nus de R$10 no cadastro NÃƒO Ã© automÃ¡tico. Deve ser adicionado manualmente via Admin/CRM.

#### 1.1.3 Cadastro RÃ¡pido (Phone-Only) âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CADASTRO RÃPIDO (SÃ“ CELULAR)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Tela: /register                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Cadastro RÃ¡pido                     â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Celular: [+55 (21) 99999-9999]      â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Cadastrar com Celular]             â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  POST /api/auth/register-phone                         â”‚
â”‚  â€¢ Cria user com nome temporÃ¡rio                       â”‚
â”‚  â€¢ profileComplete = false                             â”‚
â”‚  â€¢ Envia SMS                                           â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  Tela: Verificar SMS (igual fluxo tradicional)         â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  Login realizado                                       â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚      â”‚profileComplete?â”‚                                â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚              â”‚                                          â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚      â”‚               â”‚                                 â”‚
â”‚      â–¼               â–¼                                 â”‚
â”‚   false           true                                 â”‚
â”‚      â”‚               â”‚                                 â”‚
â”‚      â–¼               â–¼                                 â”‚
â”‚  /complete-      /cardapio                             â”‚
â”‚   profile                                              â”‚
â”‚      â”‚                                                 â”‚
â”‚      â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ Nome: [___] â”‚                                       â”‚
â”‚  â”‚ Email:[___] â”‚                                       â”‚
â”‚  â”‚ Senha:[___] â”‚                                       â”‚
â”‚  â”‚  (opcional) â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚      â”‚                                                 â”‚
â”‚      â–¼                                                 â”‚
â”‚  profileComplete = true                                â”‚
â”‚      â”‚                                                 â”‚
â”‚      â–¼                                                 â”‚
â”‚  /cardapio                                             â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.1.4 Login/Cadastro com Google OAuth

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               LOGIN/CADASTRO COM GOOGLE                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Tela: /login ou /register                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚   [ğŸ”µ Entrar com Google]            â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€ ou â”€â”€â”€â”€â”€â”€â”€                â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚   Email/Celular: [__________]       â”‚               â”‚
â”‚  â”‚   Senha: [__________]               â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Clica "Entrar com Google"               â”‚
â”‚              â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  Google Login Popup                 â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚  â€¢ Escolhe conta Google             â”‚               â”‚
â”‚  â”‚  â€¢ Autoriza FLAME                   â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  Callback: credential JWT recebido                     â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  POST /api/auth/google { credential }                  â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  Backend valida token com Google API                   â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚      â”‚UsuÃ¡rio existe?â”‚                                 â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚              â”‚                                          â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚      â”‚               â”‚                                 â”‚
â”‚      â–¼               â–¼                                 â”‚
â”‚    SIM             NÃƒO                                 â”‚
â”‚      â”‚               â”‚                                 â”‚
â”‚      â”‚               â–¼                                 â”‚
â”‚      â”‚    Cria novo usuÃ¡rio:                           â”‚
â”‚      â”‚    â€¢ googleId = sub                             â”‚
â”‚      â”‚    â€¢ email (do Google)                          â”‚
â”‚      â”‚    â€¢ nome (do Google)                           â”‚
â”‚      â”‚    â€¢ profileComplete = true                     â”‚
â”‚      â”‚    â€¢ phoneVerified = false                      â”‚
â”‚      â”‚               â”‚                                 â”‚
â”‚      â”‚  Toast: "Bem-vindo ao FLAME! ğŸ”¥"                â”‚
â”‚      â”‚               â”‚                                 â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  JWT gerado + user retornado                           â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  Zustand: salva { user, token }                        â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  /cardapio (acesso imediato)                           â”‚
â”‚                                                         â”‚
â”‚  Nota: Celular pode ser adicionado                     â”‚
â”‚        posteriormente em /perfil                       â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.1.5 Login SMS

```
Tela: /login
    â”‚
    â”œâ”€â”€ Input: Celular
    â”‚
    â–¼
[Enviar cÃ³digo] â†’ SMS enviado
    â”‚
    â–¼
Input: CÃ³digo 6 dÃ­gitos
    â”‚
    â–¼
[Verificar] â†’ VÃ¡lido?
    â”‚
    â”œâ”€â”€ Sim â†’ JWT gerado â†’ SessÃ£o criada â†’ /cardapio
    â”‚
    â””â”€â”€ NÃ£o â†’ Erro "CÃ³digo invÃ¡lido"
```

---

### 1.2 Pedido na Mesa

#### 1.2.1 Fluxo Completo de Pedido

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               FLUXO DE PEDIDO (MESA)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  CARDÃPIO (/cardapio)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ [ğŸ” Buscar...]                      â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Categorias:                         â”‚               â”‚
â”‚  â”‚ [Drinks] [Cervejas] [Comidas] [Nar- â”‚               â”‚
â”‚  â”‚                              guilÃ©] â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚               â”‚
â”‚  â”‚ â”‚ Produto â”‚ â”‚ Produto â”‚ ...        â”‚               â”‚
â”‚  â”‚ â”‚ R$ XX   â”‚ â”‚ R$ XX   â”‚            â”‚               â”‚
â”‚  â”‚ â”‚ [+]     â”‚ â”‚ [+]     â”‚            â”‚               â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ ğŸ›’ Carrinho (3) - R$ 89,00 [Ver]   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Clica em produto                        â”‚
â”‚              â–¼                                          â”‚
â”‚  MODAL PRODUTO                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ [Imagem do Produto]                 â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Nome do Produto                     â”‚               â”‚
â”‚  â”‚ R$ 35,00                            â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ DescriÃ§Ã£o do produto lorem ipsum    â”‚               â”‚
â”‚  â”‚ dolor sit amet...                   â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Quantidade: [-] 1 [+]               â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ ObservaÃ§Ãµes:                        â”‚               â”‚
â”‚  â”‚ [Sem gelo, por favor]               â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Adicionar ao Carrinho - R$ 35,00]  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Adiciona                                â”‚
â”‚              â–¼                                          â”‚
â”‚  Toast: "Adicionado! ğŸ”¥"                               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Continua navegando ou...                â”‚
â”‚              â–¼                                          â”‚
â”‚  CARRINHO (/carrinho)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Seus Itens                          â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚               â”‚
â”‚  â”‚ â”‚ Caipirinha    [-] 2 [+]  R$50 â”‚   â”‚               â”‚
â”‚  â”‚ â”‚ [ğŸ—‘ï¸]                          â”‚   â”‚               â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚               â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚               â”‚
â”‚  â”‚ â”‚ PorÃ§Ã£o Fritas [-] 1 [+]  R$35 â”‚   â”‚               â”‚
â”‚  â”‚ â”‚ [ğŸ—‘ï¸]                          â”‚   â”‚               â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ Subtotal:              R$ 85,00     â”‚               â”‚
â”‚  â”‚ Taxa de serviÃ§o (10%): R$ 8,50 [x]  â”‚ â† RemovÃ­vel  â”‚
â”‚  â”‚ TOTAL:                 R$ 93,50     â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Continuar Comprando]               â”‚               â”‚
â”‚  â”‚ [Finalizar Pedido]                  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Finalizar                               â”‚
â”‚              â–¼                                          â”‚
â”‚  CHECKOUT (/checkout) âš ï¸ ATUALIZADO                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Confirme seu pedido                 â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ ğŸ“ Mesa: 07                         â”‚               â”‚
â”‚  â”‚    [Trocar mesa]                    â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ ğŸ’³ PAGAR PELO APP:                  â”‚               â”‚
â”‚  â”‚    â—‹ CartÃ£o de CrÃ©dito              â”‚               â”‚
â”‚  â”‚    â—‹ CartÃ£o de DÃ©bito               â”‚               â”‚
â”‚  â”‚    â— PIX (Recomendado)              â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ ğŸ™‹ PAGAR COM ATENDENTE:             â”‚               â”‚
â”‚  â”‚    â—‹ Dinheiro                       â”‚               â”‚
â”‚  â”‚    â—‹ CartÃ£o na Mesa                 â”‚               â”‚
â”‚  â”‚    â—‹ Dividir Conta                  â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ Subtotal:         R$ 85,00          â”‚               â”‚
â”‚  â”‚ Taxa serviÃ§o:     R$ 8,50    [x]    â”‚ â† RemovÃ­vel  â”‚
â”‚  â”‚ TOTAL:            R$ 93,50          â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ ğŸ”¥ Ganhe 5% de cashback!            â”‚               â”‚
â”‚  â”‚ Poste no Instagram @flamelounge_    â”‚               â”‚
â”‚  â”‚ Seu @: [@___________]               â”‚               â”‚
â”‚  â”‚ [âœ“] Quero participar                â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Confirmar Pedido]                  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Confirma                                â”‚
â”‚              â–¼                                          â”‚
â”‚  PAGAMENTO (se PIX)                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ [QR Code PIX]                       â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Valor: R$ 93,50                     â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Copiar cÃ³digo]                     â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ â±ï¸ Expira em: 14:58                 â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Aguardando pagamento...             â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Pagamento confirmado                    â”‚
â”‚              â–¼                                          â”‚
â”‚  PEDIDO CRIADO                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ âœ… Pedido #0127 confirmado!         â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Acompanhe em tempo real:            â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Ver meu pedido]                    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.2.1b Fluxo Pagamento com Atendente âœ… IMPLEMENTADO (Sprint A)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               PAGAMENTO COM ATENDENTE + TROCO                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  CHECKOUT - Cliente seleciona forma de pagamento:                  â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ™‹ PAGAR COM ATENDENTE:                                     â”‚    â”‚
â”‚  â”‚    â—‹ Dinheiro                                               â”‚    â”‚
â”‚  â”‚    â—‹ CartÃ£o na Mesa                                         â”‚    â”‚
â”‚  â”‚    â—‹ Dividir Conta                                          â”‚    â”‚
â”‚  â”‚    â— Pagar Depois                                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚                                                      â”‚
â”‚              â”‚ Se selecionar DINHEIRO â†’                             â”‚
â”‚              â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ’° Precisa de troco?       [Toggle ON]                      â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Troco para quanto?                                          â”‚    â”‚
â”‚  â”‚ [R$ 100,00_]                                                â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ âœ… Troco: R$ 6,50                                           â”‚    â”‚
â”‚  â”‚ (Total: R$ 93,50)                                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  PEDIDO CRIADO (status: pending_payment)                            â”‚
â”‚  â€¢ paymentMethod: 'cash'                                            â”‚
â”‚  â€¢ notes inclui: "[TROCO] Cliente precisa de troco para R$ 100,00  â”‚
â”‚                   (Troco: R$ 6,50)"                                 â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  NOTIFICAÃ‡ÃƒO SOCKET.IO â†’ Atendentes (room: 'attendants')            â”‚
â”‚  Event: 'payment_request'                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ”” PAGAMENTO NA MESA                                        â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Mesa 07 â”‚ Pedido #0127 â”‚ R$ 93,50                           â”‚    â”‚
â”‚  â”‚ Forma: DINHEIRO                                             â”‚    â”‚
â”‚  â”‚ âš ï¸ Cliente precisa de troco para R$ 100,00                  â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ [Ver Pedido]                                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  Painel Atendente - ABA "PAGAMENTOS (1)":                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Mesa 07 â”‚ Pedido #0127                                      â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Cliente: JoÃ£o Silva                                         â”‚    â”‚
â”‚  â”‚ Itens: 2x Caipirinha, 1x PorÃ§Ã£o Fritas                      â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Total: R$ 93,50                                             â”‚    â”‚
â”‚  â”‚ Forma: Dinheiro                                             â”‚    â”‚
â”‚  â”‚ Esperando: 2 min                                            â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ [Confirmar Pagamento]                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚                                                      â”‚
â”‚              â”‚ Clica "Confirmar Pagamento"                          â”‚
â”‚              â–¼                                                      â”‚
â”‚  MODAL CONFIRMAÃ‡ÃƒO:                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ’³ Confirmar Pagamento                                      â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Pedido: #0127 â”‚ Mesa: 07                                    â”‚    â”‚
â”‚  â”‚ Cliente: JoÃ£o Silva                                         â”‚    â”‚
â”‚  â”‚ Forma: Dinheiro                                             â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Total a Receber: R$ 93,50                                   â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Valor Recebido (opcional): R$ [100,00]                      â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ ğŸ’¡ Troco: R$ 6,50                                           â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ [Confirmar Recebimento] [Cancelar]                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚                                                      â”‚
â”‚              â”‚ Confirma                                             â”‚
â”‚              â–¼                                                      â”‚
â”‚  POST /api/orders/:id/confirm-payment                               â”‚
â”‚  { amountReceived: 100.00, change: 6.50 }                           â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  Backend atualiza:                                                  â”‚
â”‚  â€¢ order.status = 'confirmed'                                       â”‚
â”‚  â€¢ order.paymentStatus = 'completed'                                â”‚
â”‚  â€¢ order.attendantId = atendente.id                                 â”‚
â”‚  â€¢ order.confirmedAt = new Date()                                   â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  Se cash â†’ Registra em CashMovement:                                â”‚
â”‚  â€¢ type: 'entrada'                                                  â”‚
â”‚  â€¢ amount: 93.50                                                    â”‚
â”‚  â€¢ amountReceived: 100.00                                           â”‚
â”‚  â€¢ change: 6.50                                                     â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  Socket.IO notifica:                                                â”‚
â”‚  â€¢ Cliente: "payment_confirmed" â†’ "Pagamento confirmado! Seu        â”‚    â”‚
â”‚    pedido estÃ¡ sendo preparado."                                    â”‚
â”‚  â€¢ Cozinha/Bar: "new_kitchen_order"/"new_bar_order" â†’ Mostra        â”‚    â”‚
â”‚    pedido para preparo                                              â”‚
â”‚  â€¢ Caixa: Atualiza dashboard                                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Arquivos Implementados:**
- âœ… Backend: [orderController.js](d:\flame\backend\src\controllers\orderController.js) - `createOrder()`, `confirmAttendantPayment()`, `getPendingPayments()`
- âœ… Backend: [Order.js](d:\flame\backend\src\models\Order.js) - `isAttendantPayment()`, status `pending_payment`
- âœ… Backend: [socket.service.js](d:\flame\backend\src\services\socket.service.js) - `notifyPaymentRequest()`, `notifyPaymentConfirmed()`
- âœ… Backend: [routes/orders.js](d:\flame\backend\src\routes\orders.js) - Rotas `/pending-payments`, `/:id/confirm-payment`
- âœ… Frontend: [checkout.js](d:\flame\frontend\src\pages\checkout.js) - UI de troco no Step 3
- âœ… Frontend: [atendente/index.js](d:\flame\frontend\src\pages\atendente\index.js) - Aba "Pagamentos" + Modal de confirmaÃ§Ã£o

#### 1.2.1c Fluxo DivisÃ£o de Conta (NOVO!)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DIVISÃƒO DE CONTA                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Cliente seleciona "Dividir Conta"                                  â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  Atendente Ã© notificado â†’ Vai Ã  mesa                                â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  Painel Atendente:                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Mesa 07 â”‚ DIVIDIR CONTA                                     â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Total: R$ 220,00 (2 pedidos)                                â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Dividir em:                                                 â”‚    â”‚
â”‚  â”‚   â— Partes iguais: [2] [3] [4] [5] [6]                     â”‚    â”‚
â”‚  â”‚     R$ 110,00 por pessoa (2 pessoas)                        â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚   â—‹ Valores diferentes                                      â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Pessoa 1:                                                   â”‚    â”‚
â”‚  â”‚   Valor: R$ 110,00                                          â”‚    â”‚
â”‚  â”‚   Forma: [CrÃ©dito â–¼]  [Pago âœ“]                             â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Pessoa 2:                                                   â”‚    â”‚
â”‚  â”‚   Valor: R$ 110,00                                          â”‚    â”‚
â”‚  â”‚   Forma: [PIX â–¼]      [Aguardando]                         â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚    â”‚
â”‚  â”‚ Restante: R$ 0,00                                           â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ [Finalizar DivisÃ£o]                                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  Quando todos pagaram:                                              â”‚
â”‚  - Pedido(s) confirmado(s)                                          â”‚
â”‚  - Registra movimento no caixa                                      â”‚
â”‚  - Cada cliente recebe notificaÃ§Ã£o                                  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.2.1d Fluxo Cashback Instagram (NOVO!)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CASHBACK INSTAGRAM                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  No checkout, cliente marca "Quero participar"                      â”‚
â”‚  Informa @instagram                                                 â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  Pedido criado com: instagramPromoOptIn = true                      â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  Pedido preparado â†’ Atendente vai entregar                          â”‚
â”‚              â”‚                                                      â”‚
â”‚              â–¼                                                      â”‚
â”‚  Painel Atendente (na entrega):                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Pedido #0127 â”‚ Mesa 07                                      â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ ğŸ“¸ CLIENTE PARTICIPA DO INSTAGRAM CASHBACK                  â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ Instagram do cliente: @usuario_cliente                      â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ â„¹ï¸ InstruÃ§Ãµes:                                              â”‚    â”‚
â”‚  â”‚ 1. PeÃ§a para o cliente mostrar o celular                   â”‚    â”‚
â”‚  â”‚ 2. Verifique se postou foto do pedido                      â”‚    â”‚
â”‚  â”‚ 3. Verifique se marcou @flamelounge_                       â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚ [âœ“ Cliente Postou] [âœ— NÃ£o Postou]                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚                                                      â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚      â”‚               â”‚                                             â”‚
â”‚      â–¼               â–¼                                             â”‚
â”‚  Confirmou       NÃ£o postou                                        â”‚
â”‚      â”‚               â”‚                                             â”‚
â”‚      â–¼               â–¼                                             â”‚
â”‚  Credita 5%    Pedido normal                                       â”‚
â”‚  cashback      (sem cashback                                       â”‚
â”‚  extra          Instagram)                                         â”‚
â”‚      â”‚                                                             â”‚
â”‚      â–¼                                                             â”‚
â”‚  NotificaÃ§Ã£o para cliente:                                         â”‚
â”‚  "ğŸ‰ VocÃª ganhou R$ X,XX de cashback                               â”‚
â”‚   pela sua postagem no Instagram!"                                 â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.2.2 Acompanhamento do Pedido

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TRACKING (/pedido/{id})                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Pedido #0127                                          â”‚
â”‚  Mesa 07                                               â”‚
â”‚                                                         â”‚
â”‚  Timeline:                                             â”‚
â”‚                                                         â”‚
â”‚  âœ… Pedido recebido         14:32                      â”‚
â”‚  â”‚                                                     â”‚
â”‚  âœ… Em preparo              14:35                      â”‚
â”‚  â”‚  â””â”€ Cozinha: PorÃ§Ã£o Fritas                         â”‚
â”‚  â”‚  â””â”€ Bar: Caipirinha (2)                            â”‚
â”‚  â”‚                                                     â”‚
â”‚  ğŸ”„ Pronto para entrega     --:--                      â”‚
â”‚  â”‚                                                     â”‚
â”‚  â—‹ Entregue                 --:--                      â”‚
â”‚                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚
â”‚                                                         â”‚
â”‚  Itens:                                                â”‚
â”‚  â€¢ 2x Caipirinha            R$ 50,00                   â”‚
â”‚  â€¢ 1x PorÃ§Ã£o Fritas         R$ 35,00                   â”‚
â”‚                                                         â”‚
â”‚  Total pago: R$ 83,50                                  â”‚
â”‚  (+R$ 4,18 de cashback acumulado!)                     â”‚
â”‚                                                         â”‚
â”‚  [Preciso de ajuda]                                    â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Eventos Socket.IO:
- 'order_status_update' â†’ Atualiza timeline
- 'order_ready' â†’ NotificaÃ§Ã£o push
- 'order_delivered' â†’ Mostra botÃ£o avaliar
```

---

### 1.3 Pedido no BalcÃ£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               FLUXO BALCÃƒO                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Acesso direto (sem QR)                                â”‚
â”‚  URL: flame.com.br                                     â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  Login/Cadastro (igual)                                â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  CardÃ¡pio (sem mesa definida)                          â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  Carrinho â†’ Checkout                                   â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  SELEÃ‡ÃƒO DE ENTREGA                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Como deseja receber?                â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ â—‹ Estou em uma mesa                 â”‚               â”‚
â”‚  â”‚   [Selecionar mesa â–¼]               â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ â— Retirar no balcÃ£o                 â”‚               â”‚
â”‚  â”‚   VocÃª receberÃ¡ uma notificaÃ§Ã£o     â”‚               â”‚
â”‚  â”‚   quando estiver pronto!            â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Marca "BalcÃ£o"                          â”‚
â”‚              â–¼                                          â”‚
â”‚  Pagamento â†’ Pedido criado                             â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  Tracking especial:                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Pedido #0128 (BALCÃƒO)               â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ âœ… Recebido                         â”‚               â”‚
â”‚  â”‚ ğŸ”„ Preparando...                    â”‚               â”‚
â”‚  â”‚ â—‹ Pronto - Retire no balcÃ£o         â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Quando estiver pronto, vocÃª         â”‚               â”‚
â”‚  â”‚ receberÃ¡ uma notificaÃ§Ã£o.           â”‚               â”‚
â”‚  â”‚ Procure nosso atendente.            â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Status = 'ready'                        â”‚
â”‚              â–¼                                          â”‚
â”‚  NOTIFICAÃ‡ÃƒO PUSH:                                     â”‚
â”‚  "ğŸ”¥ Pedido #0128 pronto! Retire no balcÃ£o"           â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 1.4 NarguilÃ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               FLUXO NARGUILÃ‰                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  No CardÃ¡pio: Categoria "NarguilÃ©"                     â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  SELEÃ‡ÃƒO DE SABOR                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ ğŸŒ€ NarguilÃ© FLAME                   â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ R$ 60/hora (sabor incluso)          â”‚               â”‚
â”‚  â”‚ MÃ­nimo 30 minutos                   â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Escolha o sabor:                    â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ CLÃSSICOS (inclusos):               â”‚               â”‚
â”‚  â”‚ â—‹ Menta                             â”‚               â”‚
â”‚  â”‚ â—‹ LimÃ£o                             â”‚               â”‚
â”‚  â”‚ â— Uva                               â”‚               â”‚
â”‚  â”‚ â—‹ MaÃ§Ã£                              â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ PREMIUM (+R$15):                    â”‚               â”‚
â”‚  â”‚ â—‹ Blue Ice                          â”‚               â”‚
â”‚  â”‚ â—‹ Love 66                           â”‚               â”‚
â”‚  â”‚ â—‹ Mint Chocolate                    â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ SIGNATURE (+R$20):                  â”‚               â”‚
â”‚  â”‚ â—‹ FLAME Special (segredo da casa)   â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Adicionar ao Pedido]               â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Adiciona                                â”‚
â”‚              â–¼                                          â”‚
â”‚  No carrinho aparece:                                  â”‚
â”‚  "NarguilÃ© - Uva (tempo a definir)"                   â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Faz checkout                            â”‚
â”‚              â–¼                                          â”‚
â”‚  Pedido criado â†’ Bar recebe                            â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Bar prepara e entrega                   â”‚
â”‚              â–¼                                          â”‚
â”‚  TIMER INICIA (no sistema)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ ğŸŒ€ Seu NarguilÃ©                     â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Sabor: Uva                          â”‚               â”‚
â”‚  â”‚ Mesa: 07                            â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚     â±ï¸ 00:42:15                     â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ PrÃ³xima troca de carvÃ£o: 02:45      â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Solicitar troca de carvÃ£o]         â”‚               â”‚
â”‚  â”‚ [Encerrar narguilÃ©]                 â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Cliente encerra                         â”‚
â”‚              â–¼                                          â”‚
â”‚  FECHAMENTO                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ NarguilÃ© encerrado                  â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Tempo total: 1h 15min               â”‚               â”‚
â”‚  â”‚ Valor: R$ 75,00                     â”‚               â”‚
â”‚  â”‚ (R$60 primeira hora + R$15 15min)   â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Adicionado Ã  sua conta!             â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 1.5 Reserva de Mesa

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               FLUXO RESERVA                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Menu â†’ "Reservar Mesa"                                â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  CALENDÃRIO                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Reservar Mesa                       â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚       Dezembro 2024                 â”‚               â”‚
â”‚  â”‚ Dom Seg Ter Qua Qui Sex SÃ¡b        â”‚               â”‚
â”‚  â”‚                           1   2     â”‚               â”‚
â”‚  â”‚   3   4   5   6   7  [8]  9        â”‚               â”‚
â”‚  â”‚  ...                                â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ HorÃ¡rios disponÃ­veis (08/12):       â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [18:00] [19:00] [20:00] [21:00]    â”‚               â”‚
â”‚  â”‚ [22:00]                             â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Seleciona 20:00                         â”‚
â”‚              â–¼                                          â”‚
â”‚  DETALHES                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Quantas pessoas?                    â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚      [-]   4   [+]                  â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ ObservaÃ§Ãµes:                        â”‚               â”‚
â”‚  â”‚ [AniversÃ¡rio, mesa perto do bar]    â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ ğŸ“… 08/12 Ã s 20:00                   â”‚               â”‚
â”‚  â”‚ ğŸ‘¥ 4 pessoas                        â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Solicitar Reserva]                 â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  CONFIRMAÃ‡ÃƒO                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ âœ… Reserva solicitada!              â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ VocÃª receberÃ¡ uma confirmaÃ§Ã£o       â”‚               â”‚
â”‚  â”‚ em breve via SMS.                   â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ ğŸ“… 08/12 Ã s 20:00                   â”‚               â”‚
â”‚  â”‚ ğŸ‘¥ 4 pessoas                        â”‚               â”‚
â”‚  â”‚ Status: Aguardando confirmaÃ§Ã£o      â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ (Sistema envia WhatsApp para FLAME  â”‚               â”‚
â”‚  â”‚  com os detalhes da reserva)        â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Ver minhas reservas]               â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Staff confirma                          â”‚
â”‚              â–¼                                          â”‚
â”‚  SMS: "ğŸ”¥ Reserva confirmada! 08/12 Ã s 20:00"         â”‚
â”‚                                                         â”‚
â”‚  No dia, 2h antes:                                     â”‚
â”‚  WhatsApp: "Lembrete: sua reserva Ã© hoje Ã s 20:00!"   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 1.6 Programa de Cashback

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               FLUXO CASHBACK                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Menu â†’ "Meu Cashback"                                 â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  DASHBOARD CASHBACK                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ ğŸ”¥ FLAME Rewards                    â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚       R$ 34,00                      â”‚               â”‚
â”‚  â”‚    cashback disponÃ­vel              â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ NÃ­vel: SILVER ğŸ¥ˆ                    â”‚               â”‚
â”‚  â”‚ Cashback: 5% em cada compra         â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ R$160 p/ Gold      â”‚               â”‚
â”‚  â”‚ VocÃª jÃ¡ gastou R$4.840 (total)      â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Ver BenefÃ­cios]  [HistÃ³rico]       â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Ver benefÃ­cios                          â”‚
â”‚              â–¼                                          â”‚
â”‚  BENEFÃCIOS POR TIER                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Seu nÃ­vel: SILVER ğŸ¥ˆ                â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ âœ… 5% de cashback                   â”‚               â”‚
â”‚  â”‚ âœ… Prioridade em reservas           â”‚               â”‚
â”‚  â”‚ âœ… R$ 50 no aniversÃ¡rio             â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ PrÃ³ximo nÃ­vel: GOLD ğŸ¥‡              â”‚               â”‚
â”‚  â”‚ Faltam R$ 160 em compras            â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ BenefÃ­cios do Gold:                 â”‚               â”‚
â”‚  â”‚ â€¢ 8% de cashback                    â”‚               â”‚
â”‚  â”‚ â€¢ Mesa reservada                    â”‚               â”‚
â”‚  â”‚ â€¢ R$ 100 no aniversÃ¡rio             â”‚               â”‚
â”‚  â”‚ â€¢ 1 drink cortesia/mÃªs              â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â”‚ Ver histÃ³rico                           â”‚
â”‚              â–¼                                          â”‚
â”‚  HISTÃ“RICO CASHBACK                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Ãšltimas transaÃ§Ãµes                  â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ 05/12 â”‚ Pedido #127  â”‚ +R$ 4,18    â”‚               â”‚
â”‚  â”‚ 03/12 â”‚ Usado        â”‚ -R$ 10,00   â”‚               â”‚
â”‚  â”‚ 01/12 â”‚ Pedido #119  â”‚ +R$ 3,50    â”‚               â”‚
â”‚  â”‚ 28/11 â”‚ Pedido #112  â”‚ +R$ 5,25    â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Saldo atual: R$ 34,00               â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

**Como funciona hoje:**
|- VocÃª ganha cashback automaticamente em cada pedido entregue e pago, de acordo com seu tier.
|- O saldo e o histÃ³rico ficam visÃ­veis no mÃ³dulo "Meu Cashback" (app) e nas telas de CRM/Admin.
|- O uso como desconto direto no checkout ainda **nÃ£o estÃ¡ ativo**; a regra planejada Ã© permitir usar atÃ© cerca de 50% do valor do pedido em cashback.

**Validade:**
|- Um job diÃ¡rio expira saldos de cashback que ficaram mais de 90 dias sem novas transaÃ§Ãµes de ganho ou bÃ´nus.
```

---

## 2. FLUXOS DO STAFF

### 2.1 Login Staff

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               LOGIN FUNCIONÃRIO                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  URL: /staff/login                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ ğŸ”¥ FLAME Staff                      â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Email:                              â”‚               â”‚
â”‚  â”‚ [joao@flame.com.br]                 â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Senha:                              â”‚               â”‚
â”‚  â”‚ [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢]                          â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Entrar]                            â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  Sistema verifica role â†’ Redireciona                   â”‚
â”‚                                                         â”‚
â”‚  role = 'kitchen'   â†’ /staff/cozinha                   â”‚
â”‚  role = 'bar'       â†’ /staff/bar                       â”‚
â”‚  role = 'attendant' â†’ /staff/atendente                 â”‚
â”‚  role = 'cashier'   â†’ /staff/caixa                     â”‚
â”‚  role = 'manager'   â†’ /staff/dashboard                 â”‚
â”‚  role = 'admin'     â†’ /admin                           â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Painel Cozinha

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               COZINHA (/staff/cozinha)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ³ Cozinha         [ğŸ”” 3]        JoÃ£o ğŸ‘¤       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  FILA DE PEDIDOS (comida)                              â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ #0127 â”‚ Mesa 07 â”‚ ğŸ• 12min         â”‚  NOVO        â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ â€¢ 1x PorÃ§Ã£o Fritas                  â”‚               â”‚
â”‚  â”‚ â€¢ 1x HambÃºrguer Artesanal           â”‚               â”‚
â”‚  â”‚   (Obs: Sem cebola)                 â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Iniciar Preparo]                   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ #0125 â”‚ Mesa 03 â”‚ ğŸ• 18min         â”‚  PREPARANDO  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  âš ï¸ ATRASANDOâ”‚
â”‚  â”‚ â€¢ 2x PorÃ§Ã£o Bolinho                 â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Marcar Pronto]                     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ #0124 â”‚ BalcÃ£o â”‚ ğŸ• 05min          â”‚  PREPARANDO  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ â€¢ 1x TÃ¡bua de Frios                 â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Marcar Pronto]                     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚
â”‚  ğŸ“Š Hoje: 47 pedidos â”‚ Tempo mÃ©dio: 14min             â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Eventos Socket.IO (recebe):
- 'new_kitchen_order' â†’ Adiciona card + som

Eventos Socket.IO (emite):
- 'start_preparing' â†’ {orderId, itemIds}
- 'item_ready' â†’ {orderId, itemId}
- 'order_kitchen_ready' â†’ {orderId}
```

### 2.3 Painel Bar

> **âœ… NOTA Sprint 58**: O Bar agora gerencia APENAS bebidas. NarguilÃ© foi migrado para o Atendente e requer mesa (balcÃ£o bloqueado).

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               BAR (/staff/bar)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  [BEBIDAS]                              Maria ğŸ‘¤       â”‚
â”‚                                                         â”‚
â”‚  === FILA DE BEBIDAS ===                               â”‚
â”‚                                                         â”‚
â”‚  EM PREPARO (2)                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ #0127 â”‚ Mesa 07 â”‚ ğŸ• 05min          â”‚               â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ â€¢ 2x Caipirinha                     â”‚               â”‚
â”‚  â”‚ â€¢ 1x Gin TÃ´nica                     â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Pronto] â† BotÃ£o ativo              â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  AGUARDANDO (1)                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ #0129 â”‚ Mesa 03 â”‚ NOVO              â”‚               â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ â€¢ 3x Cerveja Artesanal              â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Preparar] â† Primeiro botÃ£o         â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Fluxo de BotÃµes (Bar/Cozinha):
1. Pedido chega â†’ Status "pending" â†’ BotÃ£o [Preparar]
2. Clica [Preparar] â†’ Status "preparing" â†’ BotÃ£o [Pronto]
3. Clica [Pronto] â†’ Status "ready" â†’ Pedido SAI da tela
   â†’ Vai para tela do Atendente
```

### 2.4 Painel Atendente

> **NOTA**: Atendente agora controla tambÃ©m o NARGUILÃ‰ (migrado do Bar)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ATENDENTE (/atendente)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  [PRONTOS]  [ENTREGUES]  [BALCÃƒO]  [NARGUILÃ‰]  Pedro ğŸ‘¤â”‚
â”‚                                                         â”‚
â”‚  === ABA PRONTOS ===                                   â”‚
â”‚                                                         â”‚
â”‚  EM ENTREGA (status: on_way)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ #0124 â”‚ Mesa 07 â”‚ ğŸ• 1min          â”‚  COMIGO       â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ â€¢ 1x TÃ¡bua de Frios                 â”‚               â”‚
â”‚  â”‚ â€¢ 1x Cerveja                        â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Entregar] â† Finaliza entrega       â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  PRONTOS PARA RETIRAR (status: ready)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ #0125 â”‚ Mesa 03 â”‚ ğŸ• 2min pronto    â”‚               â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ â€¢ 2x PorÃ§Ã£o Bolinho (COZINHA âœ…)    â”‚               â”‚
â”‚  â”‚ â€¢ 2x Caipirinha (BAR âœ…)            â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Retirar] â† BotÃ£o (readyâ†’on_way)    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  âš ï¸ BotÃ£o fica BLOQUEADO enquanto status != ready      â”‚
â”‚                                                         â”‚
â”‚  === ABA NARGUILÃ‰ (NOVO!) ===                          â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Mesa 07 â”‚ Uva â”‚ â±ï¸ 00:42:15        â”‚               â”‚
â”‚  â”‚ PrÃ³ximo carvÃ£o: 02:45               â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ [Trocar CarvÃ£o] [Pausar] [Finalizar]â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Fluxo de BotÃµes (Atendente):
1. Pedido fica "ready" na Cozinha/Bar â†’ Aparece para Atendente
2. BotÃ£o [Retirar] fica ATIVO â†’ Clica â†’ Status "on_way"
3. BotÃ£o [Entregar] aparece â†’ Clica â†’ Status "delivered"
4. Pedido SAI da tela

IMPORTANTE: BotÃµes do Atendente ficam BLOQUEADOS atÃ© o pedido
estar "ready". Ele nÃ£o pode acelerar o preparo da Cozinha/Bar.
```

### 2.5 Painel Caixa

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 CAIXA (/staff/caixa)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  CAIXA #1 â”‚ Aberto 18:02 â”‚ Carlos ğŸ‘¤                  â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ RESUMO DO TURNO                     â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚ Abertura:     R$ 200,00             â”‚               â”‚
â”‚  â”‚ + Dinheiro:   R$ 1.250,00           â”‚               â”‚
â”‚  â”‚ + PIX:        R$ 3.420,00           â”‚               â”‚
â”‚  â”‚ + CartÃ£o:     R$ 2.890,00           â”‚               â”‚
â”‚  â”‚ - Sangrias:   R$ 500,00             â”‚               â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚               â”‚
â”‚  â”‚ Em caixa:     R$ 950,00             â”‚               â”‚
â”‚  â”‚ Total vendas: R$ 7.560,00           â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  [Sangria]  [Suprimento]  [Venda Manual]              â”‚
â”‚                                                         â”‚
â”‚  ÃšLTIMAS MOVIMENTAÃ‡Ã•ES                                 â”‚
â”‚                                                         â”‚
â”‚  18:45 â”‚ Venda #0128 â”‚ PIX     â”‚ +R$ 93,50            â”‚
â”‚  18:42 â”‚ Venda #0127 â”‚ CartÃ£o  â”‚ +R$ 156,00           â”‚
â”‚  18:30 â”‚ Sangria     â”‚ -       â”‚ -R$ 200,00           â”‚
â”‚  18:15 â”‚ Venda #0125 â”‚ Dinheiroâ”‚ +R$ 85,00            â”‚
â”‚  ...                                                   â”‚
â”‚                                                         â”‚
â”‚  [Fechar Caixa]                                        â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.6 Fluxo Chat Staff-Cliente (Sprint 56/58) âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CHAT STAFF-CLIENTE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  CLIENTE (em /pedido/[id])           ATENDENTE          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Pedido #0127        â”‚    â”‚ Chats Ativos    [3] â”‚    â”‚
â”‚  â”‚ Status: Preparando  â”‚    â”‚                     â”‚    â”‚
â”‚  â”‚                     â”‚    â”‚ â€¢ #0127 JoÃ£o - 2min â”‚    â”‚
â”‚  â”‚ [ğŸ’¬ Chat]           â”‚    â”‚ â€¢ #0125 Maria - 5minâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                            â”‚                  â”‚
â”‚         â–¼                            â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Chat com Atendente  â”‚    â”‚ Chat #0127 - JoÃ£o   â”‚    â”‚
â”‚  â”‚                     â”‚    â”‚                     â”‚    â”‚
â”‚  â”‚ Sistema: Pedido     â”‚ â†â”€â”€â”‚ Sistema: Pedido     â”‚    â”‚
â”‚  â”‚          recebido   â”‚    â”‚          recebido   â”‚    â”‚
â”‚  â”‚                     â”‚    â”‚                     â”‚    â”‚
â”‚  â”‚ VocÃª: Podem colocar â”‚ â”€â”€â†’â”‚ JoÃ£o: Podem colocar â”‚    â”‚
â”‚  â”‚       gelo extra?   â”‚    â”‚       gelo extra?   â”‚    â”‚
â”‚  â”‚                     â”‚    â”‚                     â”‚    â”‚
â”‚  â”‚ Staff: Claro! JÃ¡    â”‚ â†â”€â”€â”‚ VocÃª: Claro! JÃ¡     â”‚    â”‚
â”‚  â”‚        anotamos.    â”‚    â”‚       anotamos.     â”‚    â”‚
â”‚  â”‚                     â”‚    â”‚                     â”‚    â”‚
â”‚  â”‚ [Mensagem...]  [â–¶]  â”‚    â”‚ [Mensagem...]  [â–¶]  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  Eventos Socket.IO:                                     â”‚
â”‚  - 'chat_message' â†’ Notifica ambos os lados            â”‚
â”‚  - 'message_read' â†’ Marca como lida                    â”‚
â”‚                                                         â”‚
â”‚  Backend: /api/chat/:orderId                           â”‚
â”‚  Model: Message (orderId, senderId, senderType,        â”‚
â”‚         content, isRead, readAt)                       â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.7 Fluxo Pagamento com Atendente (Sprint 43/58) âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PAGAMENTO COM ATENDENTE (Dinheiro/Cartao)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  1. CLIENTE SELECIONA "PAGAR COM ATENDENTE"            â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â”‚ Formas de Pagamento:                â”‚            â”‚
â”‚     â”‚ â—‹ PIX (app)                         â”‚            â”‚
â”‚     â”‚ â—‹ Cartao (app)                      â”‚            â”‚
â”‚     â”‚ â— Dinheiro (atendente vai a mesa)   â”‚            â”‚
â”‚     â”‚ â—‹ Cartao na Mesa (atendente)        â”‚            â”‚
â”‚     â”‚                                     â”‚            â”‚
â”‚     â”‚ [Confirmar Pedido]                  â”‚            â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                  â”‚                                      â”‚
â”‚                  â–¼                                      â”‚
â”‚  2. PEDIDO CRIADO COM STATUS: pending_payment          â”‚
â”‚     POST /api/orders { paymentMethod: 'pay_later' }    â”‚
â”‚                  â”‚                                      â”‚
â”‚                  â–¼                                      â”‚
â”‚  3. NOTIFICACAO PARA ATENDENTE (Socket.IO + Som)       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â”‚ [!] PAGAMENTO NA MESA               â”‚            â”‚
â”‚     â”‚                                     â”‚            â”‚
â”‚     â”‚ Mesa 07 | #0127 | R$ 132,00        â”‚            â”‚
â”‚     â”‚ Metodo: Dinheiro                    â”‚            â”‚
â”‚     â”‚                                     â”‚            â”‚
â”‚     â”‚ [Ver Detalhes]                      â”‚            â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                  â”‚                                      â”‚
â”‚                  â–¼                                      â”‚
â”‚  4. ATENDENTE CONFIRMA (Sprint 58)                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â”‚ Confirmar Pagamento #0127           â”‚            â”‚
â”‚     â”‚                                     â”‚            â”‚
â”‚     â”‚ Total: R$ 132,00                    â”‚            â”‚
â”‚     â”‚                                     â”‚            â”‚
â”‚     â”‚ Metodo de Pagamento:                â”‚            â”‚
â”‚     â”‚ [Dinheiro] [Credito] [Debito] [PIX] â”‚            â”‚
â”‚     â”‚     â†‘ Selecao obrigatoria          â”‚            â”‚
â”‚     â”‚                                     â”‚            â”‚
â”‚     â”‚ Valor Recebido: R$ [150,00]        â”‚            â”‚
â”‚     â”‚ Troco: R$ 18,00 (calculado)        â”‚            â”‚
â”‚     â”‚                                     â”‚            â”‚
â”‚     â”‚ [Confirmar Pagamento]               â”‚            â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                  â”‚                                      â”‚
â”‚                  â–¼                                      â”‚
â”‚  5. PEDIDO VAI PARA PREPARO (confirmed)                â”‚
â”‚     POST /api/orders/:id/confirm-payment               â”‚
â”‚     { paymentMethod, amountReceived, change }          â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.8 Fluxo Sons de Notificacao (Sprint 58) âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SISTEMA DE SONS (sound.service.js)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  SONS DISPONIVEIS:                                      â”‚
â”‚  â”œâ”€ playNewOrder()      â†’ Novo pedido chegou           â”‚
â”‚  â”œâ”€ playAlert()         â†’ Alerta geral                 â”‚
â”‚  â”œâ”€ playSuccess()       â†’ Acao concluida               â”‚
â”‚  â”œâ”€ playStatusChange()  â†’ Status mudou                 â”‚
â”‚  â””â”€ playUrgent()        â†’ Timer/urgencia               â”‚
â”‚                                                         â”‚
â”‚  DEBOUNCE (500ms):                                      â”‚
â”‚  - Evita som duplicado                                  â”‚
â”‚  - Mesmo evento em <500ms = ignora                     â”‚
â”‚  - lastPlayedRef.current = Date.now()                  â”‚
â”‚                                                         â”‚
â”‚  USO NOS PAINEIS:                                       â”‚
â”‚                                                         â”‚
â”‚  COZINHA (/cozinha)                                    â”‚
â”‚  - Novo pedido comida â†’ playNewOrder()                 â”‚
â”‚  - Pedido atrasado â†’ playUrgent()                      â”‚
â”‚                                                         â”‚
â”‚  BAR (/staff/bar)                                      â”‚
â”‚  - Novo pedido bebida â†’ playNewOrder()                 â”‚
â”‚  - Pedido atrasado â†’ playUrgent()                      â”‚
â”‚                                                         â”‚
â”‚  ATENDENTE (/atendente)                                â”‚
â”‚  - Pedido pronto â†’ playNewOrder()                      â”‚
â”‚  - Pagamento aguardando â†’ playAlert()                  â”‚
â”‚  - Nova mensagem chat â†’ playAlert()                    â”‚
â”‚                                                         â”‚
â”‚  CAIXA (/staff/caixa)                                  â”‚
â”‚  - Nova venda â†’ playSuccess()                          â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.9 Fluxo Gorjeta no Checkout (Sprint 55) âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GORJETA NO CHECKOUT                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  TELA DE CHECKOUT:                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Resumo do Pedido                                â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚ Subtotal:                        R$ 100,00     â”‚   â”‚
â”‚  â”‚ Taxa de Servico (10%):           R$  10,00     â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚ Gostaria de deixar uma gorjeta?                â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚ [ 5% ] [ 10% ] [ 15% ] [ Outro ]              â”‚   â”‚
â”‚  â”‚   R$5    R$10    R$15    [___]                â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚ Gorjeta:                         R$  10,00     â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚   â”‚
â”‚  â”‚ TOTAL:                           R$ 120,00     â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚ [Finalizar Pedido]                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  CAMPOS NO ORDER:                                       â”‚
â”‚  {                                                      â”‚
â”‚    subtotal: 100.00,                                   â”‚
â”‚    serviceFee: 10.00,                                  â”‚
â”‚    serviceFeeIncluded: true,                           â”‚
â”‚    tip: 10.00,           // Gorjeta (Sprint 55)       â”‚
â”‚    tipPercentage: 10,    // Percentual selecionado    â”‚
â”‚    total: 120.00                                       â”‚
â”‚  }                                                      â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. FLUXOS ADMINISTRATIVOS

### 3.1 Dashboard Gerente

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             DASHBOARD (/admin/dashboard)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ğŸ”¥ FLAME Dashboard          Hoje: 05/12     Admin ğŸ‘¤  â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ R$7.5k  â”‚ â”‚   67    â”‚ â”‚ R$112   â”‚ â”‚  12     â”‚      â”‚
â”‚  â”‚ Vendas  â”‚ â”‚ Pedidos â”‚ â”‚ Ticket  â”‚ â”‚ Mesas   â”‚      â”‚
â”‚  â”‚ +15% â†‘  â”‚ â”‚ +8% â†‘   â”‚ â”‚ +3% â†‘   â”‚ â”‚ ativas  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                         â”‚
â”‚  VENDAS POR HORA                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚     ğŸ“Š [GrÃ¡fico de barras]          â”‚               â”‚
â”‚  â”‚                                     â”‚               â”‚
â”‚  â”‚  18h  19h  20h  21h  22h  23h      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  PEDIDOS EM TEMPO REAL                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ â€¢ #0130 â”‚ Mesa 08 â”‚ Preparando      â”‚               â”‚
â”‚  â”‚ â€¢ #0129 â”‚ Mesa 05 â”‚ Pronto          â”‚               â”‚
â”‚  â”‚ â€¢ #0128 â”‚ BalcÃ£o  â”‚ Aguardando      â”‚               â”‚
â”‚  â”‚ â€¢ #0127 â”‚ Mesa 07 â”‚ Entregue âœ…     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  ALERTAS                                               â”‚
â”‚  âš ï¸ Estoque baixo: Vodka Absolut (2 un)               â”‚
â”‚  âš ï¸ Pedido #0125 atrasado (>20min)                    â”‚
â”‚  ğŸ“… 3 reservas para hoje Ã s 21h                        â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. FLUXOS DO SISTEMA

### 4.1 Processamento de Pedido

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            PIPELINE DE PEDIDO                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Cliente confirma pedido                               â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  [1] VALIDAÃ‡ÃƒO                                         â”‚
â”‚      â€¢ Itens disponÃ­veis?                              â”‚
â”‚      â€¢ Mesa vÃ¡lida?                                    â”‚
â”‚      â€¢ Pagamento OK?                                   â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  [2] CRIAÃ‡ÃƒO                                           â”‚
â”‚      â€¢ Gera nÃºmero do pedido                           â”‚
â”‚      â€¢ Status = 'pending_payment' ou 'confirmed'       â”‚
â”‚      â€¢ Registra no banco                               â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  [3] PAGAMENTO (se necessÃ¡rio)                         â”‚
â”‚      â€¢ Processa Stripe                                 â”‚
â”‚      â€¢ Confirma PIX                                    â”‚
â”‚      â€¢ Status = 'confirmed'                            â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  [4] DISTRIBUIÃ‡ÃƒO                                      â”‚
â”‚      â€¢ Separa itens por setor:                         â”‚
â”‚        - Comida â†’ Cozinha                              â”‚
â”‚        - Drink â†’ Bar                                   â”‚
â”‚        - NarguilÃ© â†’ Bar âš ï¸ (deveria ser Atendente)    â”‚
â”‚      â€¢ Emite Socket 'new_order' para cada setor        â”‚
â”‚      â€¢ âš ï¸ FALTA: notificar Atendente em novos pedidos â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  [5] ESTOQUE                                           â”‚
â”‚      â€¢ Para cada item:                                 â”‚
â”‚        - Baixa direta no product.stock                 â”‚
â”‚        - âš ï¸ Ficha tÃ©cnica NÃƒO implementada            â”‚
â”‚        - Verifica alertas se stock < minStock          â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  [6] CASHBACK                                          â”‚
â”‚      â€¢ Calcula cashback (valor Ã— % do tier)            â”‚
â”‚      â€¢ Registra transaÃ§Ã£o pendente                     â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  [7] NOTIFICAÃ‡ÃƒO                                       â”‚
â”‚      â€¢ Push para cliente: "Pedido confirmado!"         â”‚
â”‚      â€¢ Som no painel do setor                          â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚  [8] TRACKING                                          â”‚
â”‚      â€¢ Inicia monitoramento de tempo                   â”‚
â”‚      â€¢ Alerta se > 15min                               â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Fluxo de Entrega

```
Setor marca "Pronto"
       â”‚
       â–¼
Socket 'item_ready' â†’ Atendente
       â”‚
       â–¼
Todos itens prontos?
       â”‚
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”
   â”‚       â”‚
  NÃ£o     Sim
   â”‚       â”‚
   â–¼       â–¼
 Aguarda  Socket 'order_ready'
          â”‚
          â”œâ”€â†’ Atendente (painel)
          â”‚
          â””â”€â†’ Cliente (se balcÃ£o: push)
               â”‚
               â–¼
       Atendente "Pega pedido"
               â”‚
               â–¼
       Atendente "Entrega"
               â”‚
               â–¼
       Status = 'delivered'
               â”‚
               â”œâ”€â†’ Cliente: push "Pedido entregue!"
               â”‚
               â””â”€â†’ Cashback: confirma crÃ©dito
                      â”‚
                      â–¼
               Atualiza saldo e tier cliente
```

---

## 5. MAPEAMENTO TÃ‰CNICO

### 5.1 Arquivos por Fluxo

| Fluxo | Frontend (Pages) | Frontend (Stores) | Backend (Routes) | Backend (Controllers) | Models |
|-------|-----------------|-------------------|------------------|----------------------|--------|
| **Cadastro/Login** | `/register`, `/login`, `/complete-profile` | `authStore.js` | `auth.js` | `authController.js` | `User.js` |
| **Pedido Mesa** | `/cardapio`, `/carrinho`, `/checkout`, `/pedido/[id]` | `cartStore.js`, `orderStore.js` | `orders.js` | `orderController.js` | `Order.js`, `OrderItem.js` |
| **NarguilÃ©** | `/cardapio` (categoria), `/staff/bar` | `cartStore.js` | `hookah.js`, `orders.js` | `hookahController.js` | `HookahSession.js` |
| **Reserva** | `/reservas` | `reservationStore.js` | `reservations.js` | `reservationController.js` | `Reservation.js` |
| **Cashback** | `/perfil`, `/cashback` | `userStore.js` | `cashback.js`, `users.js` | `cashbackController.js` | `Cashback.js`, `CashbackTransaction.js` |
| **Cozinha** | `/cozinha/index.js` | `orderStore.js`, `staffStore.js` | `orders.js` | `orderController.js` | `Order.js`, `OrderItem.js` |
| **Bar** | `/staff/bar.js` | `orderStore.js`, `staffStore.js` | `orders.js`, `hookah.js` | `orderController.js` | `Order.js`, `HookahSession.js` |
| **Atendente** | `/atendente/index.js` | `orderStore.js`, `staffStore.js` | `orders.js` | `orderController.js` | `Order.js` |
| **Caixa** | `/staff/caixa.js` | `cashStore.js`, `orderStore.js` | `cash-register.js` | `cashRegisterController.js` | `CashRegister.js`, `CashMovement.js` |
| **Admin** | `/admin/*` (12 pÃ¡ginas) | `adminStore.js`, `productStore.js` | `admin.js`, `products.js` | `adminController.js` | VÃ¡rios |

### 5.2 Eventos Socket.IO

| Evento | Emissor | Receptor | Payload | DescriÃ§Ã£o |
|--------|---------|----------|---------|-----------|
| `new_order` | Backend | Cozinha/Bar | `{ order, items }` | Novo pedido criado |
| `new_kitchen_order` | Backend | Cozinha | `{ order, items }` | Itens de comida |
| `new_bar_order` | Backend | Bar | `{ order, items }` | Itens de bebida |
| `order_status_update` | Backend | Cliente/Staff | `{ orderId, status, timestamp }` | MudanÃ§a de status |
| `item_ready` | Staff | Backendâ†’Atendente | `{ orderId, itemId }` | Item pronto |
| `order_ready` | Backend | Atendente/Cliente | `{ orderId }` | Pedido completo pronto |
| `order_delivered` | Atendente | Backendâ†’Cliente | `{ orderId }` | Pedido entregue |
| `table_updated` | Backend | Admin/Atendente | `{ tableId, status }` | Status mesa mudou |
| `hookah_timer_update` | Backend | Cliente/Bar | `{ sessionId, elapsed }` | Timer narguilÃ© |

### 5.3 Endpoints Principais

#### AutenticaÃ§Ã£o
```
POST /api/auth/register        â†’ Cadastro completo
POST /api/auth/register-phone  â†’ Cadastro sÃ³ celular
POST /api/auth/login           â†’ Login email/senha
POST /api/auth/login-phone     â†’ Enviar SMS
POST /api/auth/verify-phone    â†’ Verificar cÃ³digo
POST /api/auth/google          â†’ OAuth Google
GET  /api/auth/me              â†’ Dados usuÃ¡rio logado
```

#### Pedidos
```
GET    /api/orders             â†’ Lista pedidos (filtros)
POST   /api/orders             â†’ Criar pedido
GET    /api/orders/:id         â†’ Detalhes pedido
PATCH  /api/orders/:id/status  â†’ Mudar status âš ï¸ (sem validaÃ§Ã£o de role)
GET    /api/orders/kitchen     â†’ Pedidos da cozinha
GET    /api/orders/bar         â†’ Pedidos do bar
```

#### Produtos
```
GET    /api/products           â†’ Lista produtos
GET    /api/products/:id       â†’ Detalhes produto
POST   /api/products           â†’ Criar (admin)
PUT    /api/products/:id       â†’ Editar (admin)
DELETE /api/products/:id       â†’ Remover (admin)
GET    /api/products/categories â†’ Categorias
GET    /api/products/featured  â†’ Produtos em destaque
PATCH  /api/products/:id/stock â†’ Atualizar estoque
GET    /api/products/stock/low â†’ Produtos com estoque baixo
```

#### Upload de Imagens (Sprint 30)
```
POST   /api/upload/product/:id â†’ Upload imagem para produto
POST   /api/upload/image       â†’ Upload genÃ©rico
DELETE /api/upload/image/:fn   â†’ Deletar imagem

Formatos: JPEG, PNG, GIF, WebP
Limite: 5MB por arquivo
Armazenamento: /uploads/products/
```

#### Fluxo de Upload de Imagem âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           UPLOAD DE IMAGEM (/admin/products)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Modal de Produto:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚    â”‚                                     â”‚           â”‚  â”‚
â”‚  â”‚    â”‚   [ğŸ“¤ Clique para enviar imagem]   â”‚           â”‚  â”‚
â”‚  â”‚    â”‚   JPEG, PNG, GIF ou WebP (max 5MB) â”‚           â”‚  â”‚
â”‚  â”‚    â”‚                                     â”‚           â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚    ou cole uma URL: [_________________________]      â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚                                        â”‚
â”‚                     â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ValidaÃ§Ãµes Frontend:                                  â”‚  â”‚
â”‚  â”‚ â€¢ Tipo: image/jpeg, png, gif, webp                   â”‚  â”‚
â”‚  â”‚ â€¢ Tamanho: <= 5MB                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚                                        â”‚
â”‚                     â–¼                                        â”‚
â”‚  POST /api/upload/product/{productId}                       â”‚
â”‚  Content-Type: multipart/form-data                          â”‚
â”‚  Body: { image: File }                                      â”‚
â”‚                     â”‚                                        â”‚
â”‚                     â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Backend (multer middleware):                          â”‚  â”‚
â”‚  â”‚ 1. Valida tipo MIME                                  â”‚  â”‚
â”‚  â”‚ 2. Valida tamanho                                    â”‚  â”‚
â”‚  â”‚ 3. Gera nome Ãºnico (product-{timestamp}-{random})    â”‚  â”‚
â”‚  â”‚ 4. Salva em /uploads/products/                       â”‚  â”‚
â”‚  â”‚ 5. Atualiza product.image (se productId != 'new')    â”‚  â”‚
â”‚  â”‚ 6. Deleta imagem antiga (se existir)                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚                                        â”‚
â”‚                     â–¼                                        â”‚
â”‚  Response: { success: true, imageUrl: "..." }               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Filtros de Estoque (Sprint 30) âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         GESTÃƒO DE ESTOQUE (/admin/products)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Cards de EstatÃ­sticas:                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚Totalâ”‚ â”‚Ativoâ”‚ â”‚Inat.â”‚ â”‚Em   â”‚ â”‚Baixoâ”‚ â”‚Sem  â”‚          â”‚
â”‚  â”‚ 116 â”‚ â”‚ 110 â”‚ â”‚  6  â”‚ â”‚Est. â”‚ â”‚Est. â”‚ â”‚Est. â”‚          â”‚
â”‚  â”‚  ğŸ“¦ â”‚ â”‚  ğŸ‘  â”‚ â”‚  âš« â”‚ â”‚ âœ…  â”‚ â”‚  âš ï¸ â”‚ â”‚  âŒ â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                             â”‚
â”‚  Filtros:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ” [Buscar produtos...]                               â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Status: [Todos â–¼]  Estoque: [Todos â–¼]                â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Categoria: [Todos] [Drinks] [Petiscos] [...]         â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Filtros ativos: [Ativos âœ•] [Estoque Baixo âœ•]         â”‚  â”‚
â”‚  â”‚                 [Limpar todos]                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Staff
```
GET  /api/staff/dashboard      â†’ MÃ©tricas gerente
GET  /api/staff/tables         â†’ Mapa de mesas
POST /api/staff/tables/:id/status â†’ Atualizar mesa
```

### 5.4 Status de Pedido (MÃ¡quina de Estados)

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         ESTADOS DO PEDIDO               â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚pending_paymentâ”‚ â† Pedido criado, aguarda pagamento
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ (pagamento confirmado)
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  confirmed   â”‚ â† Pedido pago, aguarda preparo
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ (staff inicia preparo)
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  preparing   â”‚ â† Em preparo (Cozinha/Bar)
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ (todos itens prontos)
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    ready     â”‚ â† Pronto para retirada
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ (atendente pega)
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   on_way     â”‚ â† A caminho da mesa
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ (atendente entrega)
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  delivered   â”‚ â† Entregue (cashback creditado)
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         âš ï¸ DIVERGÃŠNCIA: Qualquer staff pode mudar para qualquer status
            (deveria ter validaÃ§Ãµes por role)
```

### 5.5 Tiers de Cashback

| Tier | Gasto Acumulado | % Cashback | Campos no User |
|------|-----------------|------------|----------------|
| Bronze | R$ 0 - 499 | 2% | `cashbackTier: 'bronze'` |
| Silver | R$ 500 - 1.999 | 5% | `cashbackTier: 'silver'` |
| Gold | R$ 2.000 - 4.999 | 8% | `cashbackTier: 'gold'` |
| Platinum | R$ 5.000+ | 10% | `cashbackTier: 'platinum'` |

**Modelo Cashback:**
- `userId` - FK para User
- `balance` - Saldo disponÃ­vel
- `totalEarned` - Total ganho histÃ³rico
- `totalSpent` - Total gasto histÃ³rico

**Modelo CashbackTransaction:**
- `type`: 'earn' | 'spend' | 'bonus' | 'expire' | 'adjustment'
- `amount` - Valor da transaÃ§Ã£o
- `orderId` - FK opcional (quando vinculado a pedido)
- `description` - Motivo (ex: "Cashback pedido #127")

---

## 6. DIVERGÃŠNCIAS CONHECIDAS

| # | Fluxo | PRD/Doc | Sistema Real | Impacto | Prioridade |
|---|-------|---------|--------------|---------|------------|
| 1 | MudanÃ§a Status | Validado por role | Qualquer um muda | Alto - integridade | P0 |
| 2 | NarguilÃ© | Atendente controla | Bar controla | MÃ©dio - UX | P1 |
| 3 | Cashback no Checkout | Usar atÃ© 50% | NÃ£o implementado | Alto - receita | P0 |
| 4 | BÃ´nus Cadastro | AutomÃ¡tico R$10 | Manual via CRM | Baixo | P2 |
| 5 | BÃ´nus AniversÃ¡rio | AutomÃ¡tico | Manual | Baixo | P2 |
| 6 | No-show Reserva | AutomÃ¡tico | MÃ©todo existe, job nÃ£o | Baixo | P3 |
| 7 | Ficha TÃ©cnica | Baixa por insumo | Baixa direto produto | MÃ©dio - estoque | P1 |
| 8 | NotificaÃ§Ã£o Atendente | Em novos pedidos | NÃ£o implementado | MÃ©dio - operaÃ§Ã£o | P1 |

---

---

## 7. PROBLEMAS CRÃTICOS IDENTIFICADOS NA AUDITORIA

### 7.1 SeguranÃ§a

| Problema | Arquivo | Impacto | Prioridade |
|----------|---------|---------|------------|
| **Webhook sem autenticaÃ§Ã£o** | `orderController.js` `/payment/confirm` | Qualquer um pode confirmar pagamento | ğŸ”´ CRÃTICO |
| **CRUD produtos sem role** | `productController.js` | Qualquer usuÃ¡rio cria/edita/deleta | ğŸ”´ CRÃTICO |
| **Google credentials expostas** | `.env` no repositÃ³rio | Vazamento de credenciais | ğŸ”´ CRÃTICO |
| **WhatsApp nÃºmero pessoal** | `whatsapp.service.js:16` | Privacidade comprometida | ğŸ”´ CRÃTICO |
| **VAPID keys hardcoded** | `push.service.js:11-13` | Push inseguro | ğŸ”´ CRÃTICO |

### 7.2 Bugs de Funcionamento

| Bug | Arquivo | DescriÃ§Ã£o | Impacto |
|-----|---------|-----------|---------|
| **QR Code URL errada** | `tableController.js` (4 locais) | Gera `/table/` mas rota Ã© `/qr/` | QR nÃ£o funciona |
| **Job no-show quebrado** | `noShow.job.js:28-35` | Usa `r.time` que nÃ£o existe | No-shows nÃ£o marcados |
| **Caixa desincronizado** | `orderController.js` | Vendas dinheiro nÃ£o registram | Caixa incorreto |
| **Socket hookah falta** | `atendente/index.js` | NÃ£o escuta eventos do narguilÃ© | Sem tempo real |

### 7.3 Funcionalidades Faltando

| Funcionalidade | Status | Prioridade |
|----------------|--------|------------|
| Uso de cashback no checkout | âŒ NÃ£o implementado | P0 |
| Ficha tÃ©cnica (receita/insumos) | âŒ NÃ£o implementado | P1 |
| AutomaÃ§Ãµes CRM | âŒ NÃ£o implementado | P2 |
| Push no Service Worker | âŒ NÃ£o implementado | P1 |
| Tracking de campanhas | âŒ NÃ£o implementado | P2 |

---

## 8. CONFIRMAÃ‡Ã•ES DA AUDITORIA

### âœ… Confirmado: NarguilÃ© em `/atendente`

A migraÃ§Ã£o do narguilÃ© de `/staff/bar` para `/atendente` **foi concluÃ­da** na Sprint 23.

**LocalizaÃ§Ã£o atual**: `pages/atendente/index.js`

O atendente agora controla:
- Criar sessÃµes de narguilÃ©
- Trocar carvÃ£o
- Pausar/retomar
- Finalizar sessÃ£o

### âœ… Confirmado: Baixa de estoque automÃ¡tica

Quando um pedido Ã© criado:
1. Valida estoque disponÃ­vel
2. `Product.decrement('stock', { by: quantity })`
3. `InventoryService.recordMovement(type='saida', reason='venda')`
4. Se cancelado, restaura com `devolucao`

### âœ… Confirmado: Cashback automÃ¡tico

Quando pedido Ã© entregue (status = 'delivered'):
1. Calcula % baseado no tier do usuÃ¡rio
2. `user.addCashback(amount, orderId)`
3. Cria registro em `CashbackHistory`
4. Atualiza `cashbackBalance` do user

### âœ… Confirmado: Tiers implementados

| Tier | Gasto MÃ­nimo | Cashback |
|------|--------------|----------|
| Bronze | R$ 0 | 2% |
| Silver | R$ 1.000 | 5% |
| Gold | R$ 5.000 | 8% |
| Platinum | R$ 10.000 | 10% |

---

*FLAME User Flows v3.3.0 - Sincronizado com auditoria completa em 07/12/2024*
